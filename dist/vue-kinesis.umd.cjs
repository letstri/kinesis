(function(w,i){typeof exports=="object"&&typeof module<"u"?i(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],i):(w=typeof globalThis<"u"?globalThis:w||self,i(w["vue-kinesis"]={},w.Vue))})(this,function(w,i){"use strict";var X=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function k(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var O="Expected a function",$=0/0,B="[object Symbol]",W=/^\s+|\s+$/g,R=/^[-+]0x[0-9a-f]+$/i,A=/^0b[01]+$/i,D=/^0o[0-7]+$/i,L=parseInt,H=typeof X=="object"&&X&&X.Object===Object&&X,F=typeof self=="object"&&self&&self.Object===Object&&self,V=H||F||Function("return this")(),K=Object.prototype,N=K.toString,z=Math.max,G=Math.min,Y=function(){return V.Date.now()};function U(e,n,t){var s,u,o,l,f,a,r=0,c=!1,d=!1,v=!0;if(typeof e!="function")throw new TypeError(O);n=C(n)||0,j(t)&&(c=!!t.leading,d="maxWait"in t,o=d?z(C(t.maxWait)||0,n):o,v="trailing"in t?!!t.trailing:v);function M(m){var b=s,T=u;return s=u=void 0,r=m,l=e.apply(T,b),l}function g(m){return r=m,f=setTimeout(x,n),c?M(m):l}function h(m){var b=m-a,T=m-r,I=n-b;return d?G(I,o-T):I}function y(m){var b=m-a,T=m-r;return a===void 0||b>=n||b<0||d&&T>=o}function x(){var m=Y();if(y(m))return S(m);f=setTimeout(x,h(m))}function S(m){return f=void 0,v&&s?M(m):(s=u=void 0,l)}function ue(){f!==void 0&&clearTimeout(f),r=0,s=a=u=f=void 0}function de(){return f===void 0?l:S(Y())}function E(){var m=Y(),b=y(m);if(s=arguments,u=this,a=m,b){if(f===void 0)return g(a);if(d)return f=setTimeout(x,n),M(a)}return f===void 0&&(f=setTimeout(x,n)),l}return E.cancel=ue,E.flush=de,E}function q(e,n,t){var s=!0,u=!0;if(typeof e!="function")throw new TypeError(O);return j(t)&&(s="leading"in t?!!t.leading:s,u="trailing"in t?!!t.trailing:u),U(e,n,{leading:s,maxWait:n,trailing:u})}function j(e){var n=typeof e;return!!e&&(n=="object"||n=="function")}function J(e){return!!e&&typeof e=="object"}function Q(e){return typeof e=="symbol"||J(e)&&N.call(e)==B}function C(e){if(typeof e=="number")return e;if(Q(e))return $;if(j(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=j(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=e.replace(W,"");var t=A.test(e);return t||D.test(e)?L(e.slice(2),t?2:8):R.test(e)?$:+e}var Z=q;const _=k(Z),P=(e,n,t)=>t&&e>t?t:n&&e<n?n:e,ee=e=>{const{referencePosition:n,shape:t,event:s,cycles:u,strength:o}=e,l=s==="scroll"?window.innerWidth:t.width,f=s==="scroll"?window.innerHeight:t.height,a=(n.x-t.left)*(Math.PI*2)/l,r=(n.y-t.top)*(Math.PI*2)/f,c=l*Math.sin(a*u),d=f*Math.sin(r*u);return{x:c*o/(l/2),y:d*o/(f/2)}},te=({y:e,x:n,originX:t=50,originY:s=50,strength:u=10,event:o=null,minX:l,minY:f,maxX:a,maxY:r})=>{const c=P((n-t/50)*u,l,a),d=P((e-(o==="scroll"?-s/2:s)/50)*u,f,r);return{x:c,y:d}},ne=e=>({x:e?e.width/2:0,y:e?e.height/2:0}),ie=e=>e.bottom>=0&&e.right>=0&&e.top<=(window.innerHeight||document.documentElement.clientHeight)&&e.left<=(window.innerWidth||document.documentElement.clientWidth),p=()=>{try{return/Mobi|Android/i.test(navigator.userAgent)}catch{return!0}},oe=({target:e,event:n})=>{const t=n.clientX,s=n.clientY,u=t-e.left,o=s-e.top,l=ne(e),f=u/l.x,a=o/l.y;return{x:f,y:a,target:e}},re=({event:e,target:n})=>{if(e.gamma===null||e.beta===null)return{x:0,y:0,target:n};const t=e.gamma/45,s=e.beta/90;return{x:t,y:s,target:n}},ae=e=>{const n=(e.left-window.innerWidth)/(e.width+window.innerWidth),t=(e.top-window.innerHeight)/(e.height+window.innerHeight);return{x:n,y:t,target:e}},se=i.defineComponent({__name:"KinesisContainer",props:{tag:{default:"div"},event:{default:"move"},disabled:{type:Boolean,default:!1},duration:{default:1e3},easing:{default:"cubic-bezier(0.23, 1, 0.32, 1)"},perspective:{default:1e3}},setup(e){const n=i.ref(),t=i.ref({width:0,height:0,top:0,right:0,bottom:0,left:0}),s=i.ref(!1),u=i.ref(!1),o=i.ref({x:0,y:0}),l={orientation:"deviceorientation",scroll:"scroll",move:p()?"deviceorientation":null},f=i.ref(),a=i.computed(()=>{var g;return{move:{action:(h,y)=>oe({target:h,event:y}),condition:s.value&&!p(),type:l.move},scroll:{action:h=>ae(h),condition:!!((g=t.value)!=null&&g.height),type:l.scroll},orientation:{action:(h,y)=>re({target:h,event:y}),condition:e.event==="move"&&p(),type:l.orientation}}}),r=()=>{e.disabled||(s.value=!0)},c=()=>{e.disabled||(u.value=!0,s.value=!1)},d=_(g=>{if(e.disabled||!n.value)return;const h=g;!s.value&&!u.value&&r(),t.value=n.value.getBoundingClientRect();const y=ie(t.value),x=a.value[e.event].condition,S=a.value[e.event].action;y&&x&&(o.value=S(t.value,h),f.value={x:h.clientX,y:h.clientY})},100),v=()=>{const g=l[e.event];g&&window.addEventListener(g,d,!0)},M=()=>{const g=l[e.event];g&&window.removeEventListener(g,d,!0)};return i.onMounted(v),i.onBeforeUnmount(M),i.provide("context",i.readonly(i.reactive({duration:e.duration,easing:e.easing,event:e.event,eventData:f,isMoving:s,movement:o,shape:t}))),(g,h)=>(i.openBlock(),i.createBlock(i.resolveDynamicComponent(g.tag),{ref_key:"container",ref:n,style:i.normalizeStyle({perspective:`${g.perspective}px`}),onMousemove:i.unref(d),onMouseenter:r,onMouseleave:c},{default:i.withCtx(()=>[i.renderSlot(g.$slots,"default")]),_:3},40,["style","onMousemove"]))}}),ce=(e,n,t)=>{const s=(a,r)=>`translate3d(${-a}px, ${-r}px, 0)`,u=(a,r)=>{let c=0;return e.value?e.value==="x"?c=2*a:e.value==="y"&&(c=2*r):c=a+r,`rotate3d(0,0,1,${c}deg)`},o=(a,r,c)=>`rotateX(${-r}deg) rotateY(${a}deg) translate3d(0,0,${c*2}px)`,l=(a,r)=>{const c=Math.sign(n.value)*(Math.abs(a)+Math.abs(r))/10+1;return`scale3d(${t.value==="scaleX"||t.value==="scale"?c:1}, ${t.value==="scaleY"||t.value==="scale"?c:1}, 1)`};return{transformSwitch:(a,r,c,d)=>{switch(a==="scaleX"||a==="scaleY"?"scale":a){case"translate":return s(r,c);case"rotate":return u(r,c);case"depth":return o(r,c,d);case"depth_inv":return o(-r,-c,d);case"scale":return l(r,c)}}}},le=i.defineComponent({__name:"KinesisElement",props:{tag:{default:"div"},type:{default:"translate"},transformOrigin:{default:"center"},originX:{default:50},originY:{default:50},strength:{default:10},axis:{default:null},maxX:{default:null},maxY:{default:null},minX:{default:null},minY:{default:null},cycle:{default:0}},setup(e){const n=i.toRef(()=>e.axis),t=i.toRef(()=>e.strength),s=i.toRef(()=>e.type),{transformSwitch:u}=ce(n,t,s),o=i.inject("context"),l=i.computed(()=>e.type==="depth"||e.type==="depth_inv"?Math.abs(e.strength):e.strength),f=i.computed(()=>{if(!o||!o.shape||!o.isMoving&&o.event==="move")return{};let r=0,c=0;const{x:d,y:v}=e.cycle<1?te({...o.movement,originX:e.originX,originY:e.originY,strength:l.value,event:o.event,minX:e.minX,minY:e.minY,maxX:e.maxX,maxY:e.maxY}):ee({referencePosition:o.event==="scroll"?{x:0,y:0}:o.eventData,shape:o.shape,event:o.event,cycles:e.cycle,strength:l.value});return o.event!=="scroll"?(r=e.axis==="y"?0:d,c=e.axis==="x"?0:v):o.event==="scroll"?(r=e.axis==="x"?v:0,c=e.axis==="y"||!e.axis?v:0):e.cycle>0&&(r=e.axis==="x"?d:0,c=e.axis==="y"?v:0),{transform:u(e.type,r,c,e.strength)}}),a=i.computed(()=>({transformOrigin:e.transformOrigin,willChange:"transform",transitionProperty:"transform",transitionDuration:`${(o==null?void 0:o.duration)??0}ms`,transitionTimingFunction:(o==null?void 0:o.easing)??"linear"}));return(r,c)=>(i.openBlock(),i.createBlock(i.resolveDynamicComponent(r.tag),{style:i.normalizeStyle({...f.value,...a.value})},{default:i.withCtx(()=>[i.renderSlot(r.$slots,"default")]),_:3},8,["style"]))}}),fe=e=>{e.component("KinesisContainer",se),e.component("KinesisElement",le)};w.kinesisPlugin=fe,Object.defineProperty(w,Symbol.toStringTag,{value:"Module"})});
